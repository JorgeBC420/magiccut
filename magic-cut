#!/bin/bash
# magic-cut: Pega el portapapeles sobre el texto seleccionado y corta lo reemplazado.

notify_error() {
    notify-send "❌ Error en Tijeras Mágicas" "$1"
    exit 1
}

if [ "$XDG_SESSION_TYPE" = "wayland" ]; then
    if ! command -v wl-copy &> /dev/null; then
        notify_error "wl-clipboard no está instalado. Usa: 'sudo apt install wl-clipboard'"
    fi
    PRIMARY=$(wl-paste -p 2>/dev/null)
    CLIPBOARD=$(wl-paste 2>/dev/null)
    echo "$CLIPBOARD" | wl-copy -p
    echo "$PRIMARY" | wl-copy
    notify-send "🔁 Tijeras Mágicas (Wayland)" "Texto intercambiado (swap mode)"
else
    if ! command -v xclip &> /dev/null; then
        notify_error "xclip no está instalado. Usa: 'sudo apt install xclip'"
    fi
    SELECTED_TEXT=$(xclip -o -selection primary 2>/dev/null)
    CLIPBOARD_TEXT=$(xclip -o -selection clipboard 2>/dev/null)
    echo "$CLIPBOARD_TEXT" | xclip -i -selection primary
    echo "$SELECTED_TEXT" | xclip -i -selection clipboard
    notify-send "✨ Tijeras Mágicas" "Texto pegado y original cortado"
fi
